### Load option
{'embed_size': 32, 'hidden_size': 50, 'lstm_dropout': 0, 'learning_rate': 0.001, 'epoch': 30, 'NMT_weight': 0, 'MLP_weight': 1, 'max_pred_len': 500, 'batch_size': 32, 'vocab_min_freq': 5, 'mlp_dropout': 0, 'mlp_layer_size': [100, 2], 'fault_type': 'MutateDataType', 'data_path': '/home/LAB/caohl/TransferExtend/data/data-diff', 'data': {'path': '/home/LAB/caohl/TransferExtend/data/data-diff/MutateDataType', 'fault_type': 'MutateDataType', 'shuffle': True, 'batch_size': 32}, 'vocab': {'min_freq': 5, 'max_size': 30000, 'share_vocab': True}, 'encoder': {'embed_size': 32, 'hidden_size': 50, 'num_layers': 1, 'dropout': 0}, 'decoder': {'embed_size': 32, 'hidden_size': 100, 'num_layers': 1, 'dropout': 0}, 'mlp': {'layer_size': [100, 2], 'dropout': 0}, 'device': device(type='cuda')}
### Load data
### Build vocabulary
source vocab size = 4101
target vocab size = 4101
### Convert text to id
### Add bos, eos and truncate data
train source max_len=500
train target max_len=187
valid source max_len=500
valid target max_len=93
test source max_len=497
test target max_len=167
### Build iterator
Num of train examples:4246
Num of valid examples:530
Num of test  examples:532
### Build net
模型为： MultitaskModel(
  (encoder): Encoder(
    (embedding): Embedding(4101, 32)
    (rnn): LSTM(32, 50, bidirectional=True)
  )
  (decoder): Decoder(
    (embedding): Embedding(4101, 32)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(132, 100)
      )
    )
    (attention): AdditiveAttention(
      (W1): Linear(in_features=200, out_features=200, bias=False)
      (w2): Linear(in_features=200, out_features=1, bias=False)
      (dropout): Dropout(p=0, inplace=False)
    )
    (dense): Linear(in_features=100, out_features=4101, bias=True)
  )
  (mlp): MLPModel(
    (model): Sequential(
      (Linear 0): Linear(in_features=100, out_features=2, bias=True)
    )
  )
)
参数个数为： 844267
### Build optimizer and loss
Start training ...
[Epoch 0/30]
Train | data_num=  4246 | time=45.1s | nmt_acc=0.005 | nmt_loss=8.357 | mlp_acc=49.388 | mlp_loss=0.696
Valid | data_num=   530 | time= 1.9s | nmt_acc=0.000 | nmt_loss=8.356 | mlp_acc=51.509 | mlp_loss=0.695
[Epoch 1/30]
Train | data_num=  4246 | time=43.5s | nmt_acc=0.009 | nmt_loss=8.356 | mlp_acc=52.732 | mlp_loss=0.691
Valid | data_num=   530 | time= 1.7s | nmt_acc=0.011 | nmt_loss=8.354 | mlp_acc=48.113 | mlp_loss=0.691
[Epoch 2/30]
Train | data_num=  4246 | time=43.5s | nmt_acc=0.010 | nmt_loss=8.355 | mlp_acc=56.147 | mlp_loss=0.680
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.000 | nmt_loss=8.353 | mlp_acc=54.717 | mlp_loss=0.678
[Epoch 3/30]
Train | data_num=  4246 | time=43.6s | nmt_acc=0.009 | nmt_loss=8.354 | mlp_acc=62.365 | mlp_loss=0.657
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.011 | nmt_loss=8.354 | mlp_acc=58.679 | mlp_loss=0.660
[Epoch 4/30]
Train | data_num=  4246 | time=43.7s | nmt_acc=0.010 | nmt_loss=8.353 | mlp_acc=68.205 | mlp_loss=0.615
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.011 | nmt_loss=8.351 | mlp_acc=68.113 | mlp_loss=0.617
[Epoch 5/30]
Train | data_num=  4246 | time=43.5s | nmt_acc=0.009 | nmt_loss=8.353 | mlp_acc=73.811 | mlp_loss=0.561
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.032 | nmt_loss=8.350 | mlp_acc=71.509 | mlp_loss=0.587
[Epoch 6/30]
Train | data_num=  4246 | time=43.2s | nmt_acc=0.016 | nmt_loss=8.354 | mlp_acc=77.037 | mlp_loss=0.502
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.021 | nmt_loss=8.353 | mlp_acc=70.000 | mlp_loss=0.578
[Epoch 7/30]
Train | data_num=  4246 | time=43.0s | nmt_acc=0.016 | nmt_loss=8.354 | mlp_acc=80.005 | mlp_loss=0.446
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.096 | nmt_loss=8.353 | mlp_acc=71.321 | mlp_loss=0.568
[Epoch 8/30]
Train | data_num=  4246 | time=43.4s | nmt_acc=0.016 | nmt_loss=8.353 | mlp_acc=83.278 | mlp_loss=0.390
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.053 | nmt_loss=8.353 | mlp_acc=72.075 | mlp_loss=0.565
[Epoch 9/30]
Train | data_num=  4246 | time=42.8s | nmt_acc=0.013 | nmt_loss=8.353 | mlp_acc=86.411 | mlp_loss=0.340
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.032 | nmt_loss=8.352 | mlp_acc=71.887 | mlp_loss=0.579
[Epoch 10/30]
Train | data_num=  4246 | time=43.0s | nmt_acc=0.014 | nmt_loss=8.353 | mlp_acc=88.719 | mlp_loss=0.288
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.064 | nmt_loss=8.353 | mlp_acc=74.340 | mlp_loss=0.563
[Epoch 11/30]
Train | data_num=  4246 | time=43.1s | nmt_acc=0.012 | nmt_loss=8.353 | mlp_acc=91.309 | mlp_loss=0.238
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.021 | nmt_loss=8.354 | mlp_acc=74.717 | mlp_loss=0.564
[Epoch 12/30]
Train | data_num=  4246 | time=43.1s | nmt_acc=0.012 | nmt_loss=8.354 | mlp_acc=93.311 | mlp_loss=0.199
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.118 | nmt_loss=8.351 | mlp_acc=75.472 | mlp_loss=0.587
[Epoch 13/30]
Train | data_num=  4246 | time=42.9s | nmt_acc=0.014 | nmt_loss=8.353 | mlp_acc=94.489 | mlp_loss=0.161
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.043 | nmt_loss=8.350 | mlp_acc=76.415 | mlp_loss=0.585
[Epoch 14/30]
Train | data_num=  4246 | time=42.8s | nmt_acc=0.012 | nmt_loss=8.353 | mlp_acc=95.596 | mlp_loss=0.136
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.075 | nmt_loss=8.351 | mlp_acc=75.849 | mlp_loss=0.610
[Epoch 15/30]
Train | data_num=  4246 | time=43.2s | nmt_acc=0.009 | nmt_loss=8.353 | mlp_acc=96.467 | mlp_loss=0.112
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.107 | nmt_loss=8.351 | mlp_acc=76.981 | mlp_loss=0.619
[Epoch 16/30]
Train | data_num=  4246 | time=43.5s | nmt_acc=0.007 | nmt_loss=8.353 | mlp_acc=97.668 | mlp_loss=0.087
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.086 | nmt_loss=8.352 | mlp_acc=75.283 | mlp_loss=0.656
[Epoch 17/30]
Train | data_num=  4246 | time=43.2s | nmt_acc=0.009 | nmt_loss=8.354 | mlp_acc=98.139 | mlp_loss=0.072
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.075 | nmt_loss=8.354 | mlp_acc=76.981 | mlp_loss=0.670
[Epoch 18/30]
Train | data_num=  4246 | time=43.4s | nmt_acc=0.014 | nmt_loss=8.353 | mlp_acc=98.846 | mlp_loss=0.054
Valid | data_num=   530 | time= 1.7s | nmt_acc=0.107 | nmt_loss=8.351 | mlp_acc=76.981 | mlp_loss=0.710
[Epoch 19/30]
Train | data_num=  4246 | time=43.6s | nmt_acc=0.018 | nmt_loss=8.354 | mlp_acc=99.199 | mlp_loss=0.042
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.032 | nmt_loss=8.353 | mlp_acc=75.849 | mlp_loss=0.738
[Epoch 20/30]
Train | data_num=  4246 | time=43.3s | nmt_acc=0.022 | nmt_loss=8.355 | mlp_acc=99.223 | mlp_loss=0.042
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.053 | nmt_loss=8.353 | mlp_acc=75.283 | mlp_loss=0.787
[Epoch 21/30]
Train | data_num=  4246 | time=43.4s | nmt_acc=0.016 | nmt_loss=8.354 | mlp_acc=99.011 | mlp_loss=0.043
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.086 | nmt_loss=8.354 | mlp_acc=76.226 | mlp_loss=0.772
[Epoch 22/30]
Train | data_num=  4246 | time=43.3s | nmt_acc=0.016 | nmt_loss=8.354 | mlp_acc=99.553 | mlp_loss=0.027
Valid | data_num=   530 | time= 1.7s | nmt_acc=0.021 | nmt_loss=8.352 | mlp_acc=76.415 | mlp_loss=0.779
[Epoch 23/30]
Train | data_num=  4246 | time=43.8s | nmt_acc=0.016 | nmt_loss=8.354 | mlp_acc=99.788 | mlp_loss=0.019
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.075 | nmt_loss=8.352 | mlp_acc=76.604 | mlp_loss=0.807
[Epoch 24/30]
Train | data_num=  4246 | time=43.6s | nmt_acc=0.017 | nmt_loss=8.354 | mlp_acc=99.764 | mlp_loss=0.017
Valid | data_num=   530 | time= 1.7s | nmt_acc=0.075 | nmt_loss=8.356 | mlp_acc=76.038 | mlp_loss=0.851
[Epoch 25/30]
Train | data_num=  4246 | time=43.7s | nmt_acc=0.024 | nmt_loss=8.356 | mlp_acc=99.835 | mlp_loss=0.015
Valid | data_num=   530 | time= 1.7s | nmt_acc=0.086 | nmt_loss=8.356 | mlp_acc=77.170 | mlp_loss=0.862
[Epoch 26/30]
Train | data_num=  4246 | time=43.3s | nmt_acc=0.022 | nmt_loss=8.355 | mlp_acc=99.788 | mlp_loss=0.013
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.053 | nmt_loss=8.356 | mlp_acc=76.604 | mlp_loss=0.949
[Epoch 27/30]
Train | data_num=  4246 | time=43.2s | nmt_acc=0.027 | nmt_loss=8.356 | mlp_acc=99.882 | mlp_loss=0.013
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.053 | nmt_loss=8.355 | mlp_acc=76.604 | mlp_loss=0.927
[Epoch 28/30]
Train | data_num=  4246 | time=43.6s | nmt_acc=0.022 | nmt_loss=8.356 | mlp_acc=99.859 | mlp_loss=0.009
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.128 | nmt_loss=8.356 | mlp_acc=76.038 | mlp_loss=0.926
[Epoch 29/30]
Train | data_num=  4246 | time=43.6s | nmt_acc=0.026 | nmt_loss=8.356 | mlp_acc=99.859 | mlp_loss=0.007
Valid | data_num=   530 | time= 1.6s | nmt_acc=0.096 | nmt_loss=8.356 | mlp_acc=76.604 | mlp_loss=0.963
